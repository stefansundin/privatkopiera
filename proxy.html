---
layout: page
title: Privatkopiera Proxy
permalink: /proxy.html
---

    <h2 id="socks">SOCKS Proxy</h2>

    <p>Du kan använda <code>tsocks</code> för att ladda ned via en SOCKS server, t.ex. om du befinner dig utomlands och inte kan se vissa program. Du måste ha en SSH server i Sverige (routrar har ofta stöd för SSH server).</p>

    <p>Exempel för Ubuntu:</p>

{% highlight shell %}
sudo apt-get install tsocks
sudo vim /etc/tsocks.conf
# Längst ned i filen, ändra detta:
# server = 127.0.0.1
# server_port = 1080
ssh server_i_sverige.se -D 1080
{% endhighlight %}

    <p>Öppna en till terminal och kör FFmpeg-kommandot med <code>tsocks</code>:</p>

{% highlight shell %}
tsocks ffmpeg -i ...
{% endhighlight %}

    <p>Chrome kan inte hämta listan med strömmar för vissa program om du befinner dig utomlands. Det går bra att använda <code>master.m3u8</code>, men du får inte högsta kvalitén. Du kan starta Chrome så här för att gå runt det:</p>

{% highlight shell %}
google-chrome --proxy-server="socks5://127.0.0.1:1080"
{% endhighlight %}

    <p>Om du använder Mac:</p>

{% highlight shell %}
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --proxy-server="socks5://127.0.0.1:1080"
{% endhighlight %}

    <p>I Firefox är det enklare att använda SOCKS. Öppna <i>Inställningar</i> och sök efter "<i>socks</i>". Klicka på knappen <i>Inställningar...</i> och kryssa för <i>Manuell proxykonfiguration</i>. Skriv in <code>localhost</code> som <i>SOCKS-värd</i> och använd port <code>1080</code>. Det är väldigt enkelt att glömma bort den här inställningen! Om du får proxy-fel senare så beror det nog på att du har glömt att återställa inställningen.</p>


    <h2 id="http_proxy">HTTP Proxy</h2>

    <p>I Windows och Mac fungerar inte <code>tsocks</code>, så det är lite svårare att använda FFmpeg med en SOCKS server. FFmpeg stöder däremot en vanlig HTTP proxy genom att sätta variabeln <code>http_proxy</code>. Exempel för Windows:</p>

{% highlight shell %}
set http_proxy=http://server_i_sverige:3128/
ffmpeg -i ...
{% endhighlight %}

    <p>Om du redan har en server med SSH så kan du port-forwarda en lokal port till en HTTP proxy på din Linux server, via din SSH-anslutning. Då behöver du inte oroa dig om att lämna proxy porten öppen för alla. Ett program som gör detta som standard är squid. I Ubuntu kan du installera squid med följande kommandon:</p>

{% highlight shell %}
sudo apt-get install squid
{% endhighlight %}

    <p>Nu måste du skicka vidare en lokal port på din dator till squid på din server. I Windows kan du använda <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">PuTTY</a> och ställa in det i <i>Connection</i> » <i>SSH</i> » <i>Tunnels</i>. Skriv in <code>3128</code> som <i>Source port</i> och <code>127.0.0.1:3128</code> som <i>Destination</i>. Lämna <i>Local</i> ikryssad. Klicka sedan på <i>Add</i>. <a href="img/putty.png">Se bild med exempel</a>.</p>

    <p>Efter detta kan du använda <code>127.0.0.1</code> istället för <code>server_i_sverige</code> i exemplet ovan:</p>

{% highlight shell %}
set http_proxy=http://127.0.0.1:3128/
ffmpeg -i ...
{% endhighlight %}

    <p>I Mac eller Linux ansluter du med:</p>

{% highlight shell %}
ssh server_i_sverige.se -L 3128:127.0.0.1:3128
{% endhighlight %}

    <p>I Mac eller Linux använder du <code>export</code> istället för <code>set</code>.</p>

    <p>Om du har en SOCKS-anslutning men du kan inte installera squid på servern så kan du installera en HTTP proxy lokalt som kan skicka HTTP över SOCKS. Ett exempel på program som kan göra detta är privoxy. För att installera på Mac kan du köra följande kommandon:</p>

{% highlight shell %}
ssh server_i_sverige.se -D 1080
brew install privoxy
echo "forward-socks5 / localhost:1080 ." >> /usr/local/etc/privoxy/config
brew services start privoxy
export http_proxy=http://127.0.0.1:8118/
ffmpeg -i ...
{% endhighlight %}

    <p>AdobeHDS stöder tyvärr inte <code>http_proxy</code> variabeln, men du kan använda följande argument:</p>

{% highlight shell %}
php AdobeHDS.php ... --fproxy --proxy http://127.0.0.1:8118/
{% endhighlight %}
